# 总结

> 引用GIthub上的仓库链接：[https://github.com/zhanglei-workspace/shopping-management-system.git](https://github.com/zhanglei-workspace/shopping-management-system.git)
>
> 这是一个综合仓库，旨在指导Java学习。这个仓库里面有四个不同难度的工程项目，分别适合不同阶段的Java学习者。前三个项目是同一个需求下，使用不同的技术知识实现的，我使用的是这个仓库中的第二个项目，下面会重点分析这个项目，工程项目路径是shopping-management-system\1\#Java菜鸟项目\lyons.eaby。

## 1.观察者模式

工程项目中，实体对象之间存在这一对多的依赖关系，这样一来就存在一类情况：当其中任意对象发生变化时，用于对象之间的相互依赖，其所有的依赖对象都会收到被依赖对象的变化通知，根据该通知，所有的观察者都要做出相对应的更新操作。

##### 使用观察者模式的思维方式，与常规思维方式会有些不同的地方

* 我们的常规思维方式会认为：所有的观察者会在一定的反应时间内发现被观察者对象的变化。这两种思维方式存在观察者与被观察者谁发现变化？谁主动？谁被动？的差异。
* 下面我举例说明：假设对象A的观察者有对象B、C和D；当对象A发生变化时。使用常规思维方式，对象A的所有观察者主动地发现对象A的变化，这时观察者是主动的，而被观察者是被动的，观察者发现被观察者的变化。使用观察者模式的思维方式，对象A变化后，主动地告知其所有的观察者自己的变化，这时被观察者是主动的，而观察者是被动的，被观察者告知观察者自己的变化。

#### 查询与中断

这两种思维方式的对比让我联想到在计算机内部的实现机制。在计算机组成原理课程中提到，CPU对于外部I/O事件的两种不同的程序实现方式——查询方式和中断方式。在这个过程中，I/O类似于被观察者，CPU类似观察者，查询方式相当于常规思维，这时，CPU不断地查询I/O设备的状态；如果I/O设备一发生变化，CPU立马可以察觉发现，并根据变化执行不同的操作。而中断方式就完全是观察者模式的体现，如果I/O设备发生变化，I/O设备会产生中断信告知CPU，CPU接收到I/O后执行相应操作；其他时间CPU保持空闲状态或执行其他操作，这样可以节省CPU资源，这个类比到程序员开发中也有同样的益处。

## 2.Git仓库项目

由于这个工程项目使用Oracle数据库作为后台数据库，还有一些环境配置方面的问题，我无法实现对它的任何运行和修改。

#### 2.1.需求分析

* 需求是关于商品超市的商品管理系统，实现了商品的买卖操作。

* 对于程序设计，实现了对数据库的增删改查操作。

* 实质就是实现售货员的商品的一系列操作。

#### 2.2.功能分析

* 工程项目存在两个实体：一个是售货员，另一个是商品。
* 工程项目中的核心功能是售货员进货和出售；附带着还实现了售货员对商品的查询和修改操作。
* 工程项目中还实现了售货员的注册和登录退出操作，结合核心功能共同使整个工程项目更具有合理性和完整性。

#### 2.3.工程中的观察者设计模式思想

* 一方面，工程项目中使用了MVC模式（model-view-controller），这个模式本来就是观察者模式思想的体现；model是被观察者，view和controller都是观察者；当model发生变化时，model会自己发消息通知view和controller。其中原理上面的理解我就不在重复。
* 另一方面，工程项目中只有两个类：商品类和售货员类；其中，售货员类是观察者，商品类是被观察者。当商品数量达到最高上限或最低下限时，会自动通知售货员停止进货和及时补货操作。举例说明：在shopping-management-system\1\#Java菜鸟项目\lyons.eaby\src\lyons\goods\BuyGoods.java中的127至137行之间的这段代码

```java
int commodity_balance = -1;
System.out.println(Integer.parseInt(goods[4]));
commodity_balance = Integer.parseInt(goods[4])-1;//目前是默认每次修改一个
System.out.println(commodity_balance);
if (commodity_balance >= 0)
{
    pstmtCommodity.setInt(1,commodity_balance);
}else 
{
    String failNumber = "数据库中商品不足";
    messShopping(request,response,failNumber);
}
```

在这个工程项目中，由于被观察者是商品类，其本质是数据库里的数据，所有对于观察者注册和删除被观察者过程就会比较特殊；其实在这个工程项目中，这两个过程就是连接和关闭数据的过程，实现过程参考代码：shopping-management-system\1\#Java菜鸟项目\lyons.eaby\src\lyons\db目录下的Dbconn.java和Dbclose.java这个两个类。

